function Qpp=Dinamic_ur10_3DOF(u)

%Dinamic_ur10_3DOF
% This script generates the dynamics model of the robot
% inputs:
% all robot and dynamics parameters and robot kinematics (Q, Qp)
% ouputs:
% vector of accelerations (Qpp)

%Joint Position
q1=u(1);
q2=u(2);
q3=u(3);
q4=u(4);
q5=u(5);
q6=u(6);

disp("position q")
disp([q1,q2,q3,q4,q5,q6])

%Joint Velocity
qp1=u(7);
qp2=u(8);
qp3=u(9);
qp4=u(10);
qp5=u(11);
qp6=u(12);
id_offset=6;

disp("velocity qp")
disp([qp1,qp2,qp3,qp4,qp5,qp6])

%Dynamic Parameters
m1= 7.778;
m2= 12.93;
m3= 3.87;
m4= 1.96;
m5= 1.96;
m6= 0.202;

% links 1 to 6
% I1xx = 0.0061063308908;
% I1yy = 0.0061063308908;
% I1zz = 0.01125; 
% 
% I2xx = 0.0314743125769; 
% I2yy = 0.0314743125769; 
% I2zz = 0.021875625; 
% 
% I3xx = 0.421753803798; 
% I3yy = 0.421753803798; 
% I3zz = 0.036365625;  
% 
% I4xx = 0.111069694097; 
% I4yy = 0.111069694097; 
% I4zz = 0.010884375;  
% 
% I5xx = 0.0051082479567; 
% I5yy = 0.0051082479567; 
% I5zz = 0.0055125;  
% 
% I6xx = 0.0051082479567; 
% I6yy = 0.0051082479567; 
% I6zz = 0.0055125;  

% links 2 to 7
I1xx = 0.0314743125769;
I1yy = 0.0314743125769;
I1zz = 0.021875625; 

I2xx = 0.421753803798; 
I2yy = 0.421753803798; 
I2zz = 0.036365625; 

I3xx = 0.111069694097; 
I3yy = 0.111069694097; 
I3zz = 0.010884375;  

I4xx = 0.0051082479567; 
I4yy = 0.0051082479567; 
I4zz = 0.0055125;  

I5xx = 0.0051082479567; 
I5yy = 0.0051082479567; 
I5zz = 0.0055125;  

I6xx = 0.000526462289415; 
I6yy = 0.000526462289415; 
I6zz = 0.000568125;  

%Gravity
g=u(id_offset+38);
%Time
t=u(id_offset+39);
%Viscous Friction Matrix
Beta(1,1)=0.25;
Beta(2,2)=0.25;
Beta(3,3)=0.25;
Beta(4,4)=0.25;
Beta(5,5)=0.25;
Beta(6,6)=0.25;
Beta=Beta*1.1;
%Gravity Vector
gx=u(id_offset+43);
gy=u(id_offset+44);
gz=u(id_offset+45);

%Joint Position Vector
Q=[q1; q2; q3; q4; q5; q6];

%Joint Velocity Vector
Qp=[qp1; qp2; qp3; qp4; qp5; qp6];

%% Model 3 DOF
% %Complete the Inertia Matrix (symbolic form)
% M= [I122 + I211/2 + I222/2 + I311/2 + I322/2 + (500049*m3)/10000 - (I311*cos(2*q2 + 2*q3))/2 + (I322*cos(2*q2 + 2*q3))/2 + (7*L9*m3)/50 + I312*sin(2*q2 + 2*q3) + 50*m3*cos(2*q2 + 2*q3) + (L3^2*m3)/2 + L7^2*m2 + (L8^2*m2)/2 + L9^2*m3 - (I211*cos(2*q2))/2 + (I222*cos(2*q2))/2 + I212*sin(2*q2) + 10*L3*m3*cos(2*q2 + q3) + (L3^2*m3*cos(2*q2))/2 + (L8^2*m2*cos(2*q2))/2 + 10*L3*m3*cos(q3), (7*m3*sin(q2 + q3))/10 - I313*sin(q2 + q3) - I223*cos(q2) - I323*cos(q2 + q3) - I213*sin(q2) + 10*L9*m3*sin(q2 + q3) + (7*L3*m3*sin(q2))/100 + L3*L9*m3*sin(q2) + L7*L8*m2*sin(q2), (7*m3*sin(q2 + q3))/10 - I313*sin(q2 + q3) - I323*cos(q2 + q3) + 10*L9*m3*sin(q2 + q3); (7*m3*sin(q2 + q3))/10 - I313*sin(q2 + q3) - I223*cos(q2) - I323*cos(q2 + q3) - I213*sin(q2) + 10*L9*m3*sin(q2 + q3) + (7*L3*m3*sin(q2))/100 + L3*L9*m3*sin(q2) + L7*L8*m2*sin(q2), I233 + I333 + 100*m3 + L3^2*m3 + L8^2*m2 + 20*L3*m3*cos(q3), I333 + 100*m3 + 10*L3*m3*cos(q3); (7*m3*sin(q2 + q3))/10 - I313*sin(q2 + q3) - I323*cos(q2 + q3) + 10*L9*m3*sin(q2 + q3), I333 + 100*m3 + 10*L3*m3*cos(q3), I333 + 100*m3];
% 
% %Complete Centripetal and Coriolis Matrix (symbolic form)
% C= [- qp2*((I322*sin(2*q2 + 2*q3))/2 - (I311*sin(2*q2 + 2*q3))/2 - I312*cos(2*q2 + 2*q3) + 50*m3*sin(2*q2 + 2*q3) - I212*cos(2*q2) - (I211*sin(2*q2))/2 + (I222*sin(2*q2))/2 + 10*L3*m3*sin(2*q2 + q3) + (L3^2*m3*sin(2*q2))/2 + (L8^2*m2*sin(2*q2))/2) - qp3*((I322*sin(2*q2 + 2*q3))/2 - (I311*sin(2*q2 + 2*q3))/2 - I312*cos(2*q2 + 2*q3) + 50*m3*sin(2*q2 + 2*q3) + 5*L3*m3*sin(2*q2 + q3) + 5*L3*m3*sin(q3)), I212*qp1*cos(2*q2) + (I211*qp1*sin(2*q2))/2 - (I222*qp1*sin(2*q2))/2 + I312*qp1*cos(2*q2 + 2*q3) + (I311*qp1*sin(2*q2 + 2*q3))/2 - (I322*qp1*sin(2*q2 + 2*q3))/2 - 50*m3*qp1*sin(2*q2 + 2*q3) - I313*qp2*cos(q2 + q3) - I313*qp3*cos(q2 + q3) + I323*qp2*sin(q2 + q3) + I323*qp3*sin(q2 + q3) + (7*m3*qp2*cos(q2 + q3))/10 + (7*m3*qp3*cos(q2 + q3))/10 - I213*qp2*cos(q2) + I223*qp2*sin(q2) - (L3^2*m3*qp1*sin(2*q2))/2 - (L8^2*m2*qp1*sin(2*q2))/2 + 10*L9*m3*qp2*cos(q2 + q3) + 10*L9*m3*qp3*cos(q2 + q3) + (7*L3*m3*qp2*cos(q2))/100 - 10*L3*m3*qp1*sin(2*q2 + q3) + L3*L9*m3*qp2*cos(q2) + L7*L8*m2*qp2*cos(q2), I312*qp1*cos(2*q2 + 2*q3) + (I311*qp1*sin(2*q2 + 2*q3))/2 - (I322*qp1*sin(2*q2 + 2*q3))/2 - 50*m3*qp1*sin(2*q2 + 2*q3) - I313*qp2*cos(q2 + q3) - I313*qp3*cos(q2 + q3) + I323*qp2*sin(q2 + q3) + I323*qp3*sin(q2 + q3) + (7*m3*qp2*cos(q2 + q3))/10 + (7*m3*qp3*cos(q2 + q3))/10 + 10*L9*m3*qp2*cos(q2 + q3) + 10*L9*m3*qp3*cos(q2 + q3) - 5*L3*m3*qp1*sin(q3) - 5*L3*m3*qp1*sin(2*q2 + q3); (qp1*(I322*sin(2*q2 + 2*q3) - I311*sin(2*q2 + 2*q3) - 2*I312*cos(2*q2 + 2*q3) + 100*m3*sin(2*q2 + 2*q3) - 2*I212*cos(2*q2) - I211*sin(2*q2) + I222*sin(2*q2) + 20*L3*m3*sin(2*q2 + q3) + L3^2*m3*sin(2*q2) + L8^2*m2*sin(2*q2)))/2, -10*L3*m3*qp3*sin(q3), -10*L3*m3*sin(q3)*(qp2 + qp3); (qp1*(I322*sin(2*q2 + 2*q3) - I311*sin(2*q2 + 2*q3) - 2*I312*cos(2*q2 + 2*q3) + 100*m3*sin(2*q2 + 2*q3) + 10*L3*m3*sin(2*q2 + q3) + 10*L3*m3*sin(q3)))/2, 10*L3*m3*qp2*sin(q3), 0];
% 
% %Complete Gravitational Torques Vector (symbolic form)
% G= [- g*gy*(m2*(L7*sin(q1) - L8*cos(q1)*cos(q2)) + m3*(L7*sin(q1) + sin(q1)*(L9 - L7 + 7/100) - L3*cos(q1)*cos(q2) - 10*cos(q1)*cos(q2)*cos(q3) + 10*cos(q1)*sin(q2)*sin(q3))) - g*gx*(m2*(L7*cos(q1) + L8*cos(q2)*sin(q1)) + m3*(L7*cos(q1) + cos(q1)*(L9 - L7 + 7/100) - 10*sin(q1)*sin(q2)*sin(q3) + L3*cos(q2)*sin(q1) + 10*cos(q2)*cos(q3)*sin(q1))); - g*gz*(10*m3*cos(q2 + q3) + L3*m3*cos(q2) + L8*m2*cos(q2)) - g*gx*cos(q1)*(10*m3*sin(q2 + q3) + L3*m3*sin(q2) + L8*m2*sin(q2)) - g*gy*sin(q1)*(10*m3*sin(q2 + q3) + L3*m3*sin(q2) + L8*m2*sin(q2)); -10*g*m3*(gz*cos(q2 + q3) + gx*sin(q2 + q3)*cos(q1) + gy*sin(q2 + q3)*sin(q1))];

%% Model 6 DOF

%Centripetal and Coriolis Matrix 
C = ;
    %2
    ;
    %3
    ;
    %4
    ;
    %5
    ;
    %6
(I6yy*qp1*sin(2*q6))/8 - (I6xx*qp1*sin(2*q6))/8 + (I6xx*qp1*cos(2*q5)*sin(2*q6))/8 - (I6yy*qp1*cos(2*q5)*sin(2*q6))/8 + (3*I6xx*qp1*cos(2*q2)*sin(2*q3)*sin(2*q4)*sin(2*q6))/8 + (3*I6xx*qp1*cos(2*q3)*sin(2*q2)*sin(2*q4)*sin(2*q6))/8 + (3*I6xx*qp1*cos(2*q4)*sin(2*q2)*sin(2*q3)*sin(2*q6))/8 - (3*I6yy*qp1*cos(2*q2)*sin(2*q3)*sin(2*q4)*sin(2*q6))/8 - (3*I6yy*qp1*cos(2*q3)*sin(2*q2)*sin(2*q4)*sin(2*q6))/8 - (3*I6yy*qp1*cos(2*q4)*sin(2*q2)*sin(2*q3)*sin(2*q6))/8 - (I6zz*qp2*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 - (I6zz*qp3*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 - (I6zz*qp4*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 - (I6zz*qp5*cos(q2)*cos(q3)*cos(q5)*sin(q4))/2 - (I6zz*qp5*cos(q2)*cos(q4)*cos(q5)*sin(q3))/2 - (I6zz*qp5*cos(q3)*cos(q4)*cos(q5)*sin(q2))/2 + (I6zz*qp2*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6zz*qp2*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6zz*qp2*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 + (I6zz*qp3*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6zz*qp3*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6zz*qp3*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 + (I6zz*qp4*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6zz*qp4*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6zz*qp4*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 + (I6zz*qp5*cos(q5)*sin(q2)*sin(q3)*sin(q4))/2 + (I6xx*qp5*sin(2*q6)*cos(q2)*cos(q3)*cos(q4))/2 - (I6yy*qp5*sin(2*q6)*cos(q2)*cos(q3)*cos(q4))/2 - (3*I6xx*qp1*cos(2*q2)*cos(2*q3)*cos(2*q4)*sin(2*q6))/8 + (3*I6yy*qp1*cos(2*q2)*cos(2*q3)*cos(2*q4)*sin(2*q6))/8 - (I6xx*qp5*sin(2*q6)*cos(q2)*sin(q3)*sin(q4))/2 - (I6xx*qp5*sin(2*q6)*cos(q3)*sin(q2)*sin(q4))/2 - (I6xx*qp5*sin(2*q6)*cos(q4)*sin(q2)*sin(q3))/2 + (I6yy*qp5*sin(2*q6)*cos(q2)*sin(q3)*sin(q4))/2 + (I6yy*qp5*sin(2*q6)*cos(q3)*sin(q2)*sin(q4))/2 + (I6yy*qp5*sin(2*q6)*cos(q4)*sin(q2)*sin(q3))/2 - (I6xx*qp1*cos(2*q2)*cos(2*q3)*cos(2*q4)*cos(2*q5)*sin(2*q6))/8 + (I6yy*qp1*cos(2*q2)*cos(2*q3)*cos(2*q4)*cos(2*q5)*sin(2*q6))/8 + (I6xx*qp2*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 + (I6xx*qp2*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 + (I6xx*qp2*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 + (I6xx*qp3*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 + (I6xx*qp3*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 + (I6xx*qp3*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 + (I6xx*qp4*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 + (I6xx*qp4*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 + (I6xx*qp4*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 - (I6yy*qp2*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 - (I6yy*qp2*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 - (I6yy*qp2*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 - (I6yy*qp3*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 - (I6yy*qp3*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 - (I6yy*qp3*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 - (I6yy*qp4*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 - (I6yy*qp4*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 - (I6yy*qp4*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 + (I6xx*qp1*cos(2*q2)*cos(2*q5)*sin(2*q3)*sin(2*q4)*sin(2*q6))/8 + (I6xx*qp1*cos(2*q3)*cos(2*q5)*sin(2*q2)*sin(2*q4)*sin(2*q6))/8 + (I6xx*qp1*cos(2*q4)*cos(2*q5)*sin(2*q2)*sin(2*q3)*sin(2*q6))/8 - (I6yy*qp1*cos(2*q2)*cos(2*q5)*sin(2*q3)*sin(2*q4)*sin(2*q6))/8 - (I6yy*qp1*cos(2*q3)*cos(2*q5)*sin(2*q2)*sin(2*q4)*sin(2*q6))/8 - (I6yy*qp1*cos(2*q4)*cos(2*q5)*sin(2*q2)*sin(2*q3)*sin(2*q6))/8 - (I6xx*qp2*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 - (I6xx*qp3*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 - (I6xx*qp4*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 + (I6yy*qp2*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 + (I6yy*qp3*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 + (I6yy*qp4*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 - (I6xx*qp2*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 - (I6xx*qp3*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 - (I6xx*qp4*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6xx*qp5*cos(2*q6)*cos(q2)*cos(q3)*cos(q5)*sin(q4))/2 + (I6xx*qp5*cos(2*q6)*cos(q2)*cos(q4)*cos(q5)*sin(q3))/2 + (I6xx*qp5*cos(2*q6)*cos(q3)*cos(q4)*cos(q5)*sin(q2))/2 + (I6yy*qp2*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6yy*qp3*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6yy*qp4*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 - (I6yy*qp5*cos(2*q6)*cos(q2)*cos(q3)*cos(q5)*sin(q4))/2 - (I6yy*qp5*cos(2*q6)*cos(q2)*cos(q4)*cos(q5)*sin(q3))/2 - (I6yy*qp5*cos(2*q6)*cos(q3)*cos(q4)*cos(q5)*sin(q2))/2 - (I6xx*qp1*cos(2*q2)*cos(2*q3)*cos(2*q6)*sin(2*q4)*cos(q5))/2 - (I6xx*qp1*cos(2*q2)*cos(2*q4)*cos(2*q6)*sin(2*q3)*cos(q5))/2 - (I6xx*qp1*cos(2*q3)*cos(2*q4)*cos(2*q6)*sin(2*q2)*cos(q5))/2 + (I6yy*qp1*cos(2*q2)*cos(2*q3)*cos(2*q6)*sin(2*q4)*cos(q5))/2 + (I6yy*qp1*cos(2*q2)*cos(2*q4)*cos(2*q6)*sin(2*q3)*cos(q5))/2 + (I6yy*qp1*cos(2*q3)*cos(2*q4)*cos(2*q6)*sin(2*q2)*cos(q5))/2 + (I6xx*qp2*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6xx*qp2*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6xx*qp2*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 + (I6xx*qp3*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6xx*qp3*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6xx*qp3*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 + (I6xx*qp4*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6xx*qp4*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6xx*qp4*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 - (I6xx*qp5*cos(2*q6)*cos(q5)*sin(q2)*sin(q3)*sin(q4))/2 - (I6yy*qp2*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 - (I6yy*qp2*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 - (I6yy*qp2*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 - (I6yy*qp3*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 - (I6yy*qp3*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 - (I6yy*qp3*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 - (I6yy*qp4*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 - (I6yy*qp4*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 - (I6yy*qp4*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 + (I6yy*qp5*cos(2*q6)*cos(q5)*sin(q2)*sin(q3)*sin(q4))/2 + (I6xx*qp1*cos(2*q6)*sin(2*q2)*sin(2*q3)*sin(2*q4)*cos(q5))/2 - (I6yy*qp1*cos(2*q6)*sin(2*q2)*sin(2*q3)*sin(2*q4)*cos(q5))/2,...
(I6xx*qp2*sin(2*q6))/4 + (I6xx*qp3*sin(2*q6))/4 + (I6xx*qp4*sin(2*q6))/4 - (I6yy*qp2*sin(2*q6))/4 - (I6yy*qp3*sin(2*q6))/4 - (I6yy*qp4*sin(2*q6))/4 - (I6zz*qp5*sin(q5))/2 + (I6xx*qp5*cos(2*q6)*sin(q5))/2 - (I6yy*qp5*cos(2*q6)*sin(q5))/2 - (I6xx*qp2*cos(2*q5)*sin(2*q6))/4 - (I6xx*qp3*cos(2*q5)*sin(2*q6))/4 - (I6xx*qp4*cos(2*q5)*sin(2*q6))/4 + (I6yy*qp2*cos(2*q5)*sin(2*q6))/4 + (I6yy*qp3*cos(2*q5)*sin(2*q6))/4 + (I6yy*qp4*cos(2*q5)*sin(2*q6))/4 - (I6zz*qp1*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6zz*qp1*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6zz*qp1*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6zz*qp1*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 + (I6xx*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 + (I6xx*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 + (I6xx*qp1*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 - (I6yy*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 - (I6yy*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 - (I6yy*qp1*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 - (I6xx*qp1*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 + (I6yy*qp1*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 - (I6xx*qp1*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6yy*qp1*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6xx*qp1*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6xx*qp1*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6xx*qp1*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 - (I6yy*qp1*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 - (I6yy*qp1*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 - (I6yy*qp1*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2,...
(I6xx*qp2*sin(2*q6))/4 + (I6xx*qp3*sin(2*q6))/4 + (I6xx*qp4*sin(2*q6))/4 - (I6yy*qp2*sin(2*q6))/4 - (I6yy*qp3*sin(2*q6))/4 - (I6yy*qp4*sin(2*q6))/4 - (I6zz*qp5*sin(q5))/2 + (I6xx*qp5*cos(2*q6)*sin(q5))/2 - (I6yy*qp5*cos(2*q6)*sin(q5))/2 - (I6xx*qp2*cos(2*q5)*sin(2*q6))/4 - (I6xx*qp3*cos(2*q5)*sin(2*q6))/4 - (I6xx*qp4*cos(2*q5)*sin(2*q6))/4 + (I6yy*qp2*cos(2*q5)*sin(2*q6))/4 + (I6yy*qp3*cos(2*q5)*sin(2*q6))/4 + (I6yy*qp4*cos(2*q5)*sin(2*q6))/4 - (I6zz*qp1*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6zz*qp1*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6zz*qp1*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6zz*qp1*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 + (I6xx*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 + (I6xx*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 + (I6xx*qp1*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 - (I6yy*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 - (I6yy*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 - (I6yy*qp1*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 - (I6xx*qp1*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 + (I6yy*qp1*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 - (I6xx*qp1*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6yy*qp1*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6xx*qp1*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6xx*qp1*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6xx*qp1*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 - (I6yy*qp1*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 - (I6yy*qp1*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 - (I6yy*qp1*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2,...
(I6xx*qp2*sin(2*q6))/4 + (I6xx*qp3*sin(2*q6))/4 + (I6xx*qp4*sin(2*q6))/4 - (I6yy*qp2*sin(2*q6))/4 - (I6yy*qp3*sin(2*q6))/4 - (I6yy*qp4*sin(2*q6))/4 - (I6zz*qp5*sin(q5))/2 + (I6xx*qp5*cos(2*q6)*sin(q5))/2 - (I6yy*qp5*cos(2*q6)*sin(q5))/2 - (I6xx*qp2*cos(2*q5)*sin(2*q6))/4 - (I6xx*qp3*cos(2*q5)*sin(2*q6))/4 - (I6xx*qp4*cos(2*q5)*sin(2*q6))/4 + (I6yy*qp2*cos(2*q5)*sin(2*q6))/4 + (I6yy*qp3*cos(2*q5)*sin(2*q6))/4 + (I6yy*qp4*cos(2*q5)*sin(2*q6))/4 - (I6zz*qp1*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6zz*qp1*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6zz*qp1*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6zz*qp1*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 + (I6xx*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 + (I6xx*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 + (I6xx*qp1*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 - (I6yy*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q3)*sin(q4))/4 - (I6yy*qp1*sin(2*q5)*sin(2*q6)*cos(q2)*cos(q4)*sin(q3))/4 - (I6yy*qp1*sin(2*q5)*sin(2*q6)*cos(q3)*cos(q4)*sin(q2))/4 - (I6xx*qp1*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 + (I6yy*qp1*sin(2*q5)*sin(2*q6)*sin(q2)*sin(q3)*sin(q4))/4 - (I6xx*qp1*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6yy*qp1*cos(2*q6)*cos(q2)*cos(q3)*cos(q4)*sin(q5))/2 + (I6xx*qp1*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 + (I6xx*qp1*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 + (I6xx*qp1*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2 - (I6yy*qp1*cos(2*q6)*cos(q2)*sin(q3)*sin(q4)*sin(q5))/2 - (I6yy*qp1*cos(2*q6)*cos(q3)*sin(q2)*sin(q4)*sin(q5))/2 - (I6yy*qp1*cos(2*q6)*cos(q4)*sin(q2)*sin(q3)*sin(q5))/2,...
0,...MISSING
0,...MISSING
];


% Inertia Matrix (symbolic form)
M=[I1yy + 0.0004410000000006302798283288644688*m1 + (m2*(79*cos(q1) - 190*sin(q1))^2)/250000 + (m2*(190*cos(q1) + 79*sin(q1))^2)/250000 + I5yy*cos(q2 + q3 + q4)^2 + I4zz*cos(q2 + q3 + q4)^2 + I4xx*sin(q2 + q3 + q4)^2 + (m6*(146366987889541120*cos(q1)*cos(q5) - 922905783138433125*cos(q1) - 3445253714938429440*cos(q2)*sin(q1) + 3221762583430168576*sin(q1)*sin(q2)*sin(q3) + 146366987889541120*cos(q2 + q3 + q4)*sin(q1)*sin(q5) + 651333096108457984*cos(q2 + q3)*sin(q1)*sin(q4) + 651333096108457984*sin(q2 + q3)*cos(q4)*sin(q1) - 3221762583430168576*cos(q2)*cos(q3)*sin(q1))^2)/31691265005705735037417580134400000000 + (m4*(6120*cos(q1)*cos(q2) - 180*sin(q1) + 5723*cos(q1)*cos(q2)*cos(q3) + 70*cos(q1)*cos(q2)*sin(q3) + 70*cos(q1)*cos(q3)*sin(q2) - 5723*cos(q1)*sin(q2)*sin(q3))^2)/100000000 + I3yy*cos(q2 + q3)^2 + (m5*(962312279877924965*sin(q1) - 3445253714938429440*cos(q1)*cos(q2) + 101330991615836160*cos(q2 + q3)*cos(q1)*sin(q4) + 101330991615836160*sin(q2 + q3)*cos(q1)*cos(q4) - 3221762583430168576*cos(q1)*cos(q2)*cos(q3) + 3221762583430168576*cos(q1)*sin(q2)*sin(q3))^2)/31691265005705735037417580134400000000 + I3xx*sin(q2 + q3)^2 + (m4*(180*cos(q1) + 6120*cos(q2)*sin(q1) - 5723*sin(q1)*sin(q2)*sin(q3) + 5723*cos(q2)*cos(q3)*sin(q1) + 70*cos(q2)*sin(q1)*sin(q3) + 70*cos(q3)*sin(q1)*sin(q2))^2)/100000000 + (m3*(17*cos(q1) + 93*cos(q2)*sin(q1))^2)/62500 + (m3*(17*sin(q1) - 93*cos(q1)*cos(q2))^2)/62500 + I2yy*cos(q2)^2 + I2xx*sin(q2)^2 + I6xx*(cos(q2 + q3 + q4)*sin(q6) + sin(q2 + q3 + q4)*cos(q5)*cos(q6))^2 + I6yy*(cos(q2 + q3 + q4)*cos(q6) - sin(q2 + q3 + q4)*cos(q5)*sin(q6))^2 + (m5*(962312279877924965*cos(q1) + 3445253714938429440*cos(q2)*sin(q1) - 3221762583430168576*sin(q1)*sin(q2)*sin(q3) - 101330991615836160*cos(q2 + q3)*sin(q1)*sin(q4) - 101330991615836160*sin(q2 + q3)*cos(q4)*sin(q1) + 3221762583430168576*cos(q2)*cos(q3)*sin(q1))^2)/31691265005705735037417580134400000000 + (m6*(922905783138433125*sin(q1) - 3445253714938429440*cos(q1)*cos(q2) - 146366987889541120*cos(q5)*sin(q1) + 146366987889541120*cos(q2 + q3 + q4)*cos(q1)*sin(q5) + 651333096108457984*cos(q2 + q3)*cos(q1)*sin(q4) + 651333096108457984*sin(q2 + q3)*cos(q1)*cos(q4) - 3221762583430168576*cos(q1)*cos(q2)*cos(q3) + 3221762583430168576*cos(q1)*sin(q2)*sin(q3))^2)/31691265005705735037417580134400000000 + I5xx*sin(q2 + q3 + q4)^2*cos(q5)^2 + I5zz*sin(q2 + q3 + q4)^2*sin(q5)^2 + I6zz*sin(q2 + q3 + q4)^2*sin(q5)^2,...
    (3530444931389676833*m6*cos(q2 + q3 + q4 + q5))/5629499534213120000000 - (74399*m6*sin(q2 + q3 - q5))/10000000 - (I6xx*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (I6xx*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (I6yy*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (63*m4*cos(q2 + q3))/500000 + (51507*m4*sin(q2 + q3))/5000000 + (1101462635548272914939*m5*sin(q2 + q3))/11258999068426240000000 + (8450863675042004439*m6*sin(q2 + q3))/90071992547409920000 - (1989*m6*sin(q2 + q5))/250000 + (I5xx*cos(q2 + q3 + q4 - 2*q5))/4 - (I5xx*cos(q2 + q3 + q4 + 2*q5))/4 + (I6xx*cos(q2 + q3 + q4 - 2*q5))/8 - (I6xx*cos(q2 + q3 + q4 + 2*q5))/8 + (I6yy*cos(q2 + q3 + q4 - 2*q5))/8 - (I6yy*cos(q2 + q3 + q4 + 2*q5))/8 - (I5zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I5zz*cos(q2 + q3 + q4 + 2*q5))/4 - (I6zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I6zz*cos(q2 + q3 + q4 + 2*q5))/4 + (1581*m3*sin(q2))/62500 + (1377*m4*sin(q2))/125000 + (29446755764264503929*m5*sin(q2))/281474976710656000000 + (225927335712288429*m6*sin(q2))/2251799813685248000 - (20465105430209584417*m6*cos(q2 + q3 + q4 - q5))/5629499534213120000000 + (169*m6*cos(q2 + q3 + q4 - 2*q5))/1000000 - (169*m6*cos(q2 + q3 + q4 + 2*q5))/1000000 - (1989*m6*sin(q2 - q5))/250000 + (1732162103780264937*m5*cos(q2 + q3 + q4))/562949953421312000000 + (1708483185745867401*m6*cos(q2 + q3 + q4))/90071992547409920000 - (74399*m6*sin(q2 + q3 + q5))/10000000 + (I6xx*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (I6xx*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (I6yy*cos(q2 + q3 + q4 + q5 + 2*q6))/8,...
    (3530444931389676833*m6*cos(q2 + q3 + q4 + q5))/5629499534213120000000 - (74399*m6*sin(q2 + q3 - q5))/10000000 - (I6xx*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (I6xx*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (I6yy*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (63*m4*cos(q2 + q3))/500000 + (51507*m4*sin(q2 + q3))/5000000 + (1101462635548272914939*m5*sin(q2 + q3))/11258999068426240000000 + (8450863675042004439*m6*sin(q2 + q3))/90071992547409920000 + (I5xx*cos(q2 + q3 + q4 - 2*q5))/4 - (I5xx*cos(q2 + q3 + q4 + 2*q5))/4 + (I6xx*cos(q2 + q3 + q4 - 2*q5))/8 - (I6xx*cos(q2 + q3 + q4 + 2*q5))/8 + (I6yy*cos(q2 + q3 + q4 - 2*q5))/8 - (I6yy*cos(q2 + q3 + q4 + 2*q5))/8 - (I5zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I5zz*cos(q2 + q3 + q4 + 2*q5))/4 - (I6zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I6zz*cos(q2 + q3 + q4 + 2*q5))/4 - (51*m3*sin(q2))/3125 - (20465105430209584417*m6*cos(q2 + q3 + q4 - q5))/5629499534213120000000 + (169*m6*cos(q2 + q3 + q4 - 2*q5))/1000000 - (169*m6*cos(q2 + q3 + q4 + 2*q5))/1000000 + (1732162103780264937*m5*cos(q2 + q3 + q4))/562949953421312000000 + (1708483185745867401*m6*cos(q2 + q3 + q4))/90071992547409920000 - (74399*m6*sin(q2 + q3 + q5))/10000000 + (I6xx*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (I6xx*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (I6yy*cos(q2 + q3 + q4 + q5 + 2*q6))/8,...
    (3530444931389676833*m6*cos(q2 + q3 + q4 + q5))/5629499534213120000000 - (I6xx*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (I6xx*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (I6yy*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (63*m4*cos(q2 + q3))/500000 + (I5xx*cos(q2 + q3 + q4 - 2*q5))/4 - (I5xx*cos(q2 + q3 + q4 + 2*q5))/4 + (I6xx*cos(q2 + q3 + q4 - 2*q5))/8 - (I6xx*cos(q2 + q3 + q4 + 2*q5))/8 + (I6yy*cos(q2 + q3 + q4 - 2*q5))/8 - (I6yy*cos(q2 + q3 + q4 + 2*q5))/8 - (I5zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I5zz*cos(q2 + q3 + q4 + 2*q5))/4 - (I6zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I6zz*cos(q2 + q3 + q4 + 2*q5))/4 - (20465105430209584417*m6*cos(q2 + q3 + q4 - q5))/5629499534213120000000 + (169*m6*cos(q2 + q3 + q4 - 2*q5))/1000000 - (169*m6*cos(q2 + q3 + q4 + 2*q5))/1000000 + (1732162103780264937*m5*cos(q2 + q3 + q4))/562949953421312000000 + (1708483185745867401*m6*cos(q2 + q3 + q4))/90071992547409920000 + (I6xx*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (I6xx*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (I6yy*cos(q2 + q3 + q4 + q5 + 2*q6))/8,...
    (20465105430209584417*m6*cos(q2 + q3 + q4 + q5))/5629499534213120000000 - (74399*m6*sin(q2 + q3 - q5))/10000000 - (I6xx*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (I6yy*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (1989*m6*sin(q2 + q5))/250000 + (I6xx*cos(q2 + q3 + q4 - 2*q6))/4 + (I6xx*cos(q2 + q3 + q4 + 2*q6))/4 - (I6yy*cos(q2 + q3 + q4 - 2*q6))/4 - (I6yy*cos(q2 + q3 + q4 + 2*q6))/4 + (3530444931389676833*m6*cos(q2 + q3 + q4 - q5))/5629499534213120000000 - (I6xx*cos(q2 + q3 + q4))/2 - I5yy*cos(q2 + q3 + q4) - (I6yy*cos(q2 + q3 + q4))/2 - (1989*m6*sin(q2 - q5))/250000 - (1347237191829094951*m5*cos(q2 + q3 + q4))/1125899906842624000000 - (169*m6*cos(q2 + q3 + q4))/250000 + (74399*m6*sin(q2 + q3 + q5))/10000000 - (I6xx*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 + q5 + 2*q6))/8 + (I6yy*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 + q5 + 2*q6))/8,...
    (I6zz*(cos(q2 + q3 + q4 + q5) - cos(q2 + q3 + q4 - q5)))/2];
%2 DONE
    (3530444931389676833*m6*cos(q2 + q3 + q4 + q5))/5629499534213120000000 - (74399*m6*sin(q2 + q3 - q5))/10000000 - (I6xx*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (I6xx*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (I6yy*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (63*m4*cos(q2 + q3))/500000 + (51507*m4*sin(q2 + q3))/5000000 + (1101462635548272914939*m5*sin(q2 + q3))/11258999068426240000000 + (8450863675042004439*m6*sin(q2 + q3))/90071992547409920000 - (1989*m6*sin(q2 + q5))/250000 + (I5xx*cos(q2 + q3 + q4 - 2*q5))/4 - (I5xx*cos(q2 + q3 + q4 + 2*q5))/4 + (I6xx*cos(q2 + q3 + q4 - 2*q5))/8 - (I6xx*cos(q2 + q3 + q4 + 2*q5))/8 + (I6yy*cos(q2 + q3 + q4 - 2*q5))/8 - (I6yy*cos(q2 + q3 + q4 + 2*q5))/8 - (I5zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I5zz*cos(q2 + q3 + q4 + 2*q5))/4 - (I6zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I6zz*cos(q2 + q3 + q4 + 2*q5))/4 + (1581*m3*sin(q2))/62500 + (1377*m4*sin(q2))/125000 + (29446755764264503929*m5*sin(q2))/281474976710656000000 + (225927335712288429*m6*sin(q2))/2251799813685248000 - (20465105430209584417*m6*cos(q2 + q3 + q4 - q5))/5629499534213120000000 + (169*m6*cos(q2 + q3 + q4 - 2*q5))/1000000 - (169*m6*cos(q2 + q3 + q4 + 2*q5))/1000000 - (1989*m6*sin(q2 - q5))/250000 + (1732162103780264937*m5*cos(q2 + q3 + q4))/562949953421312000000 + (1708483185745867401*m6*cos(q2 + q3 + q4))/90071992547409920000 - (74399*m6*sin(q2 + q3 + q5))/10000000 + (I6xx*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (I6xx*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (I6yy*cos(q2 + q3 + q4 + q5 + 2*q6))/8,...
    I5xx + I6xx/2 + I4yy + I6yy/2 + I2zz + I3zz + (361*m2)/2500 + (8649*m3)/62500 + (70212029*m4)/100000000 + (70239529*m5)/100000000 + (35806689*m6)/50000000 - (169*m6*cos(q5)^2)/250000 + (875619*m4*cos(q3))/1250000 + (875619*m5*cos(q3))/1250000 + (875619*m6*cos(q3))/1250000 + (1071*m4*sin(q3))/125000 - (51507*m5*sin(q4))/2500000 - (6621511*m6*sin(q4))/50000000 + (I6xx*cos(2*q6))/2 - (I6yy*cos(2*q6))/2 - I5xx*cos(q5)^2 - (I6xx*cos(q5)^2)/2 - (I6yy*cos(q5)^2)/2 + I5zz*cos(q5)^2 + I6zz*cos(q5)^2 - (I6xx*cos(2*q6)*cos(q5)^2)/2 + (I6yy*cos(2*q6)*cos(q5)^2)/2 - (1377*m5*cos(q3)*sin(q4))/62500 - (1377*m5*cos(q4)*sin(q3))/62500 - (177021*m6*cos(q3)*sin(q4))/1250000 - (177021*m6*cos(q4)*sin(q3))/1250000 - (74399*m6*cos(q4)*sin(q5))/2500000 - (1989*m6*cos(q3)*cos(q4)*sin(q5))/62500 + (1989*m6*sin(q3)*sin(q4)*sin(q5))/62500,...
    I5xx + I6xx/2 + I4yy + I6yy/2 + I3zz - (279*m3)/3125 + (32757629*m4)/100000000 + (32785129*m5)/100000000 + (17079489*m6)/50000000 - (169*m6*cos(q5)^2)/250000 + (875619*m4*cos(q3))/2500000 + (875619*m5*cos(q3))/2500000 + (875619*m6*cos(q3))/2500000 + (1071*m4*sin(q3))/250000 - (51507*m5*sin(q4))/2500000 - (6621511*m6*sin(q4))/50000000 + (I6xx*cos(2*q6))/2 - (I6yy*cos(2*q6))/2 - I5xx*cos(q5)^2 - (I6xx*cos(q5)^2)/2 - (I6yy*cos(q5)^2)/2 + I5zz*cos(q5)^2 + I6zz*cos(q5)^2 - (I6xx*cos(2*q6)*cos(q5)^2)/2 + (I6yy*cos(2*q6)*cos(q5)^2)/2 - (1377*m5*cos(q3)*sin(q4))/125000 - (1377*m5*cos(q4)*sin(q3))/125000 - (177021*m6*cos(q3)*sin(q4))/2500000 - (177021*m6*cos(q4)*sin(q3))/2500000 - (74399*m6*cos(q4)*sin(q5))/2500000 - (1989*m6*cos(q3)*cos(q4)*sin(q5))/125000 + (1989*m6*sin(q3)*sin(q4)*sin(q5))/125000,...
    I5xx + I6xx/2 + I4yy + I6yy/2 + (49*m4)/1000000 + (81*m5)/250000 + (1406249*m6)/100000000 - (169*m6*cos(q5)^2)/250000 + (1071*m4*sin(q3))/250000 - (51507*m5*sin(q4))/5000000 - (6621511*m6*sin(q4))/100000000 + (I6xx*cos(2*q6))/2 - (I6yy*cos(2*q6))/2 - I5xx*cos(q5)^2 - (I6xx*cos(q5)^2)/2 - (I6yy*cos(q5)^2)/2 + I5zz*cos(q5)^2 + I6zz*cos(q5)^2 - (I6xx*cos(2*q6)*cos(q5)^2)/2 + (I6yy*cos(2*q6)*cos(q5)^2)/2 - (1377*m5*cos(q3)*sin(q4))/125000 - (1377*m5*cos(q4)*sin(q3))/125000 - (177021*m6*cos(q3)*sin(q4))/2500000 - (177021*m6*cos(q4)*sin(q3))/2500000 - (74399*m6*cos(q4)*sin(q5))/5000000 - (1989*m6*cos(q3)*cos(q4)*sin(q5))/125000 + (1989*m6*sin(q3)*sin(q4)*sin(q5))/125000,...
    (15041*m6*cos(q5))/5000000 - (63*m5)/500000 + (40061*m5*sin(q4))/10000000 + (1071*m5*cos(q3)*sin(q4))/250000 + (1071*m5*cos(q4)*sin(q3))/250000 - (74399*m6*cos(q5)*sin(q4))/5000000 - I6xx*cos(q6)*sin(q5)*sin(q6) + I6yy*cos(q6)*sin(q5)*sin(q6) - (1989*m6*cos(q3)*cos(q5)*sin(q4))/125000 - (1989*m6*cos(q4)*cos(q5)*sin(q3))/125000,...
    I6zz*cos(q5)];

%3 done
    (3530444931389676833*m6*cos(q2 + q3 + q4 + q5))/5629499534213120000000 - (74399*m6*sin(q2 + q3 - q5))/10000000 - (I6xx*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (I6xx*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (I6yy*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (63*m4*cos(q2 + q3))/500000 + (51507*m4*sin(q2 + q3))/5000000 + (1101462635548272914939*m5*sin(q2 + q3))/11258999068426240000000 + (8450863675042004439*m6*sin(q2 + q3))/90071992547409920000 + (I5xx*cos(q2 + q3 + q4 - 2*q5))/4 - (I5xx*cos(q2 + q3 + q4 + 2*q5))/4 + (I6xx*cos(q2 + q3 + q4 - 2*q5))/8 - (I6xx*cos(q2 + q3 + q4 + 2*q5))/8 + (I6yy*cos(q2 + q3 + q4 - 2*q5))/8 - (I6yy*cos(q2 + q3 + q4 + 2*q5))/8 - (I5zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I5zz*cos(q2 + q3 + q4 + 2*q5))/4 - (I6zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I6zz*cos(q2 + q3 + q4 + 2*q5))/4 - (51*m3*sin(q2))/3125 - (20465105430209584417*m6*cos(q2 + q3 + q4 - q5))/5629499534213120000000 + (169*m6*cos(q2 + q3 + q4 - 2*q5))/1000000 - (169*m6*cos(q2 + q3 + q4 + 2*q5))/1000000 + (1732162103780264937*m5*cos(q2 + q3 + q4))/562949953421312000000 + (1708483185745867401*m6*cos(q2 + q3 + q4))/90071992547409920000 - (74399*m6*sin(q2 + q3 + q5))/10000000 + (I6xx*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (I6xx*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (I6yy*cos(q2 + q3 + q4 + q5 + 2*q6))/8,...
    I5xx + I6xx/2 + I4yy + I6yy/2 + I3zz - (279*m3)/3125 + (32757629*m4)/100000000 + (32785129*m5)/100000000 + (17079489*m6)/50000000 - (169*m6*cos(q5)^2)/250000 + (875619*m4*cos(q3))/2500000 + (875619*m5*cos(q3))/2500000 + (875619*m6*cos(q3))/2500000 + (1071*m4*sin(q3))/250000 - (51507*m5*sin(q4))/2500000 - (6621511*m6*sin(q4))/50000000 + (I6xx*cos(2*q6))/2 - (I6yy*cos(2*q6))/2 - I5xx*cos(q5)^2 - (I6xx*cos(q5)^2)/2 - (I6yy*cos(q5)^2)/2 + I5zz*cos(q5)^2 + I6zz*cos(q5)^2 - (I6xx*cos(2*q6)*cos(q5)^2)/2 + (I6yy*cos(2*q6)*cos(q5)^2)/2 - (1377*m5*cos(q3)*sin(q4))/125000 - (1377*m5*cos(q4)*sin(q3))/125000 - (177021*m6*cos(q3)*sin(q4))/2500000 - (177021*m6*cos(q4)*sin(q3))/2500000 - (74399*m6*cos(q4)*sin(q5))/2500000 - (1989*m6*cos(q3)*cos(q4)*sin(q5))/125000 + (1989*m6*sin(q3)*sin(q4)*sin(q5))/125000,...
    I5xx + I6xx/2 + I4yy + I6yy/2 + I3zz + (36*m3)/625 + (32757629*m4)/100000000 + (32785129*m5)/100000000 + (17079489*m6)/50000000 - (169*m6*cos(q5)^2)/250000 - (51507*m5*sin(q4))/2500000 - (6621511*m6*sin(q4))/50000000 + (I6xx*cos(2*q6))/2 - (I6yy*cos(2*q6))/2 - I5xx*cos(q5)^2 - (I6xx*cos(q5)^2)/2 - (I6yy*cos(q5)^2)/2 + I5zz*cos(q5)^2 + I6zz*cos(q5)^2 - (I6xx*cos(2*q6)*cos(q5)^2)/2 + (I6yy*cos(2*q6)*cos(q5)^2)/2 - (74399*m6*cos(q4)*sin(q5))/2500000,...
    I5xx + I6xx/2 + I4yy + I6yy/2 + (49*m4)/1000000 + (81*m5)/250000 + (1406249*m6)/100000000 - (169*m6*cos(q5)^2)/250000 - (51507*m5*sin(q4))/5000000 - (6621511*m6*sin(q4))/100000000 + (I6xx*cos(2*q6))/2 - (I6yy*cos(2*q6))/2 - I5xx*cos(q5)^2 - (I6xx*cos(q5)^2)/2 - (I6yy*cos(q5)^2)/2 + I5zz*cos(q5)^2 + I6zz*cos(q5)^2 - (I6xx*cos(2*q6)*cos(q5)^2)/2 + (I6yy*cos(2*q6)*cos(q5)^2)/2 - (74399*m6*cos(q4)*sin(q5))/5000000,...
    (15041*m6*cos(q5))/5000000 - (63*m5)/500000 + (40061*m5*sin(q4))/10000000 - (74399*m6*cos(q5)*sin(q4))/5000000 - I6xx*cos(q6)*sin(q5)*sin(q6) + I6yy*cos(q6)*sin(q5)*sin(q6),...
    I6zz*cos(q5)];    
%4 DONE
    (3530444931389676833*m6*cos(q2 + q3 + q4 + q5))/5629499534213120000000 - (I6xx*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 + (I6xx*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 - (I6xx*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - 2*q5 - 2*q6))/16 - (I6yy*cos(q2 + q3 + q4 - 2*q5 + 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 - 2*q6))/16 + (I6yy*cos(q2 + q3 + q4 + 2*q5 + 2*q6))/16 - (63*m4*cos(q2 + q3))/500000 + (I5xx*cos(q2 + q3 + q4 - 2*q5))/4 - (I5xx*cos(q2 + q3 + q4 + 2*q5))/4 + (I6xx*cos(q2 + q3 + q4 - 2*q5))/8 - (I6xx*cos(q2 + q3 + q4 + 2*q5))/8 + (I6yy*cos(q2 + q3 + q4 - 2*q5))/8 - (I6yy*cos(q2 + q3 + q4 + 2*q5))/8 - (I5zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I5zz*cos(q2 + q3 + q4 + 2*q5))/4 - (I6zz*cos(q2 + q3 + q4 - 2*q5))/4 + (I6zz*cos(q2 + q3 + q4 + 2*q5))/4 - (20465105430209584417*m6*cos(q2 + q3 + q4 - q5))/5629499534213120000000 + (169*m6*cos(q2 + q3 + q4 - 2*q5))/1000000 - (169*m6*cos(q2 + q3 + q4 + 2*q5))/1000000 + (1732162103780264937*m5*cos(q2 + q3 + q4))/562949953421312000000 + (1708483185745867401*m6*cos(q2 + q3 + q4))/90071992547409920000 + (I6xx*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (I6xx*cos(q2 + q3 + q4 + q5 + 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (I6yy*cos(q2 + q3 + q4 + q5 + 2*q6))/8,...
    I5xx + I6xx/2 + I4yy + I6yy/2 + (49*m4)/1000000 + (81*m5)/250000 + (1406249*m6)/100000000 - (169*m6*cos(q5)^2)/250000 + (1071*m4*sin(q3))/250000 - (51507*m5*sin(q4))/5000000 - (6621511*m6*sin(q4))/100000000 + (I6xx*cos(2*q6))/2 - (I6yy*cos(2*q6))/2 - I5xx*cos(q5)^2 - (I6xx*cos(q5)^2)/2 - (I6yy*cos(q5)^2)/2 + I5zz*cos(q5)^2 + I6zz*cos(q5)^2 - (I6xx*cos(2*q6)*cos(q5)^2)/2 + (I6yy*cos(2*q6)*cos(q5)^2)/2 - (1377*m5*cos(q3)*sin(q4))/125000 - (1377*m5*cos(q4)*sin(q3))/125000 - (177021*m6*cos(q3)*sin(q4))/2500000 - (177021*m6*cos(q4)*sin(q3))/2500000 - (74399*m6*cos(q4)*sin(q5))/5000000 - (1989*m6*cos(q3)*cos(q4)*sin(q5))/125000 + (1989*m6*sin(q3)*sin(q4)*sin(q5))/125000,...
    I5xx + I6xx/2 + I4yy + I6yy/2 + (49*m4)/1000000 + (81*m5)/250000 + (1406249*m6)/100000000 - (169*m6*cos(q5)^2)/250000 - (51507*m5*sin(q4))/5000000 - (6621511*m6*sin(q4))/100000000 + (I6xx*cos(2*q6))/2 - (I6yy*cos(2*q6))/2 - I5xx*cos(q5)^2 - (I6xx*cos(q5)^2)/2 - (I6yy*cos(q5)^2)/2 + I5zz*cos(q5)^2 + I6zz*cos(q5)^2 - (I6xx*cos(2*q6)*cos(q5)^2)/2 + (I6yy*cos(2*q6)*cos(q5)^2)/2 - (74399*m6*cos(q4)*sin(q5))/5000000,...
    I5xx/2 + I6xx/4 + I4yy + I6yy/4 + I5zz/2 + I6zz/2 + (49*m4)/1000000 + (81*m5)/250000 + (1372449*m6)/100000000 - (169*m6*cos(2*q5))/500000 - (I5xx*cos(2*q5))/2 - (I6xx*cos(2*q5))/4 + (I6xx*cos(2*q6))/4 - (I6yy*cos(2*q5))/4 - (I6yy*cos(2*q6))/4 + (I5zz*cos(2*q5))/2 + (I6zz*cos(2*q5))/2 - (I6xx*cos(2*q5)*cos(2*q6))/4 + (I6yy*cos(2*q5)*cos(2*q6))/4,...
    (15041*m6*cos(q5))/5000000 - (63*m5)/500000 - I6xx*cos(q6)*sin(q5)*sin(q6) + I6yy*cos(q6)*sin(q5)*sin(q6),...
    I6zz*cos(q5)];

%5 DONE
    (20465105430209584417*m6*cos(q2 + q3 + q4 + q5))/5629499534213120000000 - (74399*m6*sin(q2 + q3 - q5))/10000000 - (I6xx*cos(q2 + q3 + q4 - q5 - 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (I6yy*cos(q2 + q3 + q4 - q5 - 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 - q5 + 2*q6))/8 + (1989*m6*sin(q2 + q5))/250000 + (I6xx*cos(q2 + q3 + q4 - 2*q6))/4 + (I6xx*cos(q2 + q3 + q4 + 2*q6))/4 - (I6yy*cos(q2 + q3 + q4 - 2*q6))/4 - (I6yy*cos(q2 + q3 + q4 + 2*q6))/4 + (3530444931389676833*m6*cos(q2 + q3 + q4 - q5))/5629499534213120000000 - (I6xx*cos(q2 + q3 + q4))/2 - I5yy*cos(q2 + q3 + q4) - (I6yy*cos(q2 + q3 + q4))/2 - (1989*m6*sin(q2 - q5))/250000 - (1347237191829094951*m5*cos(q2 + q3 + q4))/1125899906842624000000 - (169*m6*cos(q2 + q3 + q4))/250000 + (74399*m6*sin(q2 + q3 + q5))/10000000 - (I6xx*cos(q2 + q3 + q4 + q5 - 2*q6))/8 + (I6xx*cos(q2 + q3 + q4 + q5 + 2*q6))/8 + (I6yy*cos(q2 + q3 + q4 + q5 - 2*q6))/8 - (I6yy*cos(q2 + q3 + q4 + q5 + 2*q6))/8,...
    (15041*m6*cos(q5))/5000000 - (63*m5)/500000 + (40061*m5*sin(q4))/10000000 + (1071*m5*cos(q3)*sin(q4))/250000 + (1071*m5*cos(q4)*sin(q3))/250000 - (74399*m6*cos(q5)*sin(q4))/5000000 - I6xx*cos(q6)*sin(q5)*sin(q6) + I6yy*cos(q6)*sin(q5)*sin(q6) - (1989*m6*cos(q3)*cos(q5)*sin(q4))/125000 - (1989*m6*cos(q4)*cos(q5)*sin(q3))/125000,...
    (15041*m6*cos(q5))/5000000 - (63*m5)/500000 + (40061*m5*sin(q4))/10000000 - (74399*m6*cos(q5)*sin(q4))/5000000 - I6xx*cos(q6)*sin(q5)*sin(q6) + I6yy*cos(q6)*sin(q5)*sin(q6),...
    (15041*m6*cos(q5))/5000000 - (63*m5)/500000 - I6xx*cos(q6)*sin(q5)*sin(q6) + I6yy*cos(q6)*sin(q5)*sin(q6),...
    I5yy + I6yy + (49*m5)/1000000 + (169*m6)/250000 + I6xx*sin(q6)^2 - I6yy*sin(q6)^2,...
    sin(q2 + q3 + q4)*sin(q5)*(I6yy*cos(q6)*(cos(q2 + q3 + q4)*cos(q6) - sin(q2 + q3 + q4)*cos(q5)*sin(q6)) + I6xx*sin(q6)*(cos(q2 + q3 + q4)*sin(q6) + sin(q2 + q3 + q4)*cos(q5)*cos(q6))) - (cos(q1)*cos(q5) + cos(q2 + q3 + q4)*sin(q1)*sin(q5))*(I6xx*sin(q6)*(sin(q2 + q3 + q4)*sin(q1)*sin(q6) + cos(q1)*cos(q6)*sin(q5) - cos(q2 + q3 + q4)*cos(q5)*cos(q6)*sin(q1)) + I6yy*cos(q6)*(sin(q2 + q3 + q4)*cos(q6)*sin(q1) - cos(q1)*sin(q5)*sin(q6) + cos(q2 + q3 + q4)*cos(q5)*sin(q1)*sin(q6))) - (I6xx*sin(q6)*(cos(q6)*sin(q1)*sin(q5) - sin(q2 + q3 + q4)*cos(q1)*sin(q6) + cos(q2 + q3 + q4)*cos(q1)*cos(q5)*cos(q6)) - I6yy*cos(q6)*(sin(q1)*sin(q5)*sin(q6) + sin(q2 + q3 + q4)*cos(q1)*cos(q6) + cos(q2 + q3 + q4)*cos(q1)*cos(q5)*sin(q6)))*(cos(q5)*sin(q1) - cos(q2 + q3 + q4)*cos(q1)*sin(q5))];
    %6 DONE
    (I6zz*(cos(q2 + q3 + q4 + q5) - cos(q2 + q3 + q4 - q5)))/2,...
    I6zz*cos(q5),...
    I6zz*cos(q5),...
    I6zz*cos(q5),...
    0,...
    I6zz];


%Gravitational Torques Vector
G=  [g*gy*(m6*((1476649253021493*sin(q1))/9007199254740992 - (153*cos(q1)*cos(q2))/250 - (13*cos(q5)*sin(q1))/500 + (1157*cos(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)))/10000 + (1157*sin(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)))/10000 + (13*sin(q5)*(cos(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)) - sin(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2))))/500 - (5723*cos(q1)*cos(q2)*cos(q3))/10000 + (5723*cos(q1)*sin(q2)*sin(q3))/10000) - m4*((153*cos(q1)*cos(q2))/250 - (9*sin(q1))/500 + (5723*cos(q1)*cos(q2)*cos(q3))/10000 + (7*cos(q1)*cos(q2)*sin(q3))/1000 + (7*cos(q1)*cos(q3)*sin(q2))/1000 - (5723*cos(q1)*sin(q2)*sin(q3))/10000) + m3*((17*sin(q1))/250 - (213*cos(q1)*cos(q2))/250) - m2*((19*cos(q1))/50 - (79*sin(q1))/500) + m5*((192462455975584993*sin(q1))/1125899906842624000 - (153*cos(q1)*cos(q2))/250 + (9*cos(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)))/500 + (9*sin(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)))/500 - (5723*cos(q1)*cos(q2)*cos(q3))/10000 + (5723*cos(q1)*sin(q2)*sin(q3))/10000)) + g*gx*(m5*((192462455975584993*cos(q1))/1125899906842624000 + (153*cos(q2)*sin(q1))/250 - (9*cos(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/500 + (9*sin(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/500 - (5723*sin(q1)*sin(q2)*sin(q3))/10000 + (5723*cos(q2)*cos(q3)*sin(q1))/10000) + m4*((9*cos(q1))/500 + (153*cos(q2)*sin(q1))/250 - (5723*sin(q1)*sin(q2)*sin(q3))/10000 + (5723*cos(q2)*cos(q3)*sin(q1))/10000 + (7*cos(q2)*sin(q1)*sin(q3))/1000 + (7*cos(q3)*sin(q1)*sin(q2))/1000) + m3*((17*cos(q1))/250 + (213*cos(q2)*sin(q1))/250) + m6*((1476649253021493*cos(q1))/9007199254740992 - (13*cos(q1)*cos(q5))/500 + (153*cos(q2)*sin(q1))/250 - (1157*cos(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/10000 + (1157*sin(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/10000 + (13*sin(q5)*(cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)) + sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2))))/500 - (5723*sin(q1)*sin(q2)*sin(q3))/10000 + (5723*cos(q2)*cos(q3)*sin(q1))/10000) + m2*((79*cos(q1))/500 + (19*sin(q1))/50));
    g*gy*(m6*((153*sin(q1)*sin(q2))/250 - (1157*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/10000 - (1157*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/10000 - (13*sin(q5)*(cos(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)) - sin(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1))))/500 + (5723*cos(q2)*sin(q1)*sin(q3))/10000 + (5723*cos(q3)*sin(q1)*sin(q2))/10000) + m4*((153*sin(q1)*sin(q2))/250 + (7*sin(q1)*sin(q2)*sin(q3))/1000 - (7*cos(q2)*cos(q3)*sin(q1))/1000 + (5723*cos(q2)*sin(q1)*sin(q3))/10000 + (5723*cos(q3)*sin(q1)*sin(q2))/10000) + m5*((153*sin(q1)*sin(q2))/250 - (9*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/500 - (9*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/500 + (5723*cos(q2)*sin(q1)*sin(q3))/10000 + (5723*cos(q3)*sin(q1)*sin(q2))/10000) + (213*m3*sin(q1)*sin(q2))/250) + g*gz*(m5*((5723*sin(q2)*sin(q3))/10000 - (5723*cos(q2)*cos(q3))/10000 - (153*cos(q2))/250 + (9*cos(q4)*(cos(q2)*sin(q3) + cos(q3)*sin(q2)))/500 + (9*sin(q4)*(cos(q2)*cos(q3) - sin(q2)*sin(q3)))/500) + m6*((5723*sin(q2)*sin(q3))/10000 - (5723*cos(q2)*cos(q3))/10000 - (153*cos(q2))/250 + (13*sin(q5)*(cos(q4)*(cos(q2)*cos(q3) - sin(q2)*sin(q3)) - sin(q4)*(cos(q2)*sin(q3) + cos(q3)*sin(q2))))/500 + (1157*cos(q4)*(cos(q2)*sin(q3) + cos(q3)*sin(q2)))/10000 + (1157*sin(q4)*(cos(q2)*cos(q3) - sin(q2)*sin(q3)))/10000) - (213*m3*cos(q2))/250 - m4*((153*cos(q2))/250 + (5723*cos(q2)*cos(q3))/10000 + (7*cos(q2)*sin(q3))/1000 + (7*cos(q3)*sin(q2))/1000 - (5723*sin(q2)*sin(q3))/10000)) + g*gx*(m5*((153*cos(q1)*sin(q2))/250 + (9*cos(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)))/500 - (9*sin(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)))/500 + (5723*cos(q1)*cos(q2)*sin(q3))/10000 + (5723*cos(q1)*cos(q3)*sin(q2))/10000) + m6*((153*cos(q1)*sin(q2))/250 + (1157*cos(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)))/10000 - (1157*sin(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)))/10000 - (13*sin(q5)*(cos(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)) + sin(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3))))/500 + (5723*cos(q1)*cos(q2)*sin(q3))/10000 + (5723*cos(q1)*cos(q3)*sin(q2))/10000) + m4*((153*cos(q1)*sin(q2))/250 - (7*cos(q1)*cos(q2)*cos(q3))/1000 + (5723*cos(q1)*cos(q2)*sin(q3))/10000 + (5723*cos(q1)*cos(q3)*sin(q2))/10000 + (7*cos(q1)*sin(q2)*sin(q3))/1000) + (213*m3*cos(q1)*sin(q2))/250);
    g*gz*(m6*((5723*sin(q2)*sin(q3))/10000 - (5723*cos(q2)*cos(q3))/10000 + (13*sin(q5)*(cos(q4)*(cos(q2)*cos(q3) - sin(q2)*sin(q3)) - sin(q4)*(cos(q2)*sin(q3) + cos(q3)*sin(q2))))/500 + (1157*cos(q4)*(cos(q2)*sin(q3) + cos(q3)*sin(q2)))/10000 + (1157*sin(q4)*(cos(q2)*cos(q3) - sin(q2)*sin(q3)))/10000) - m4*((5723*cos(q2)*cos(q3))/10000 + (7*cos(q2)*sin(q3))/1000 + (7*cos(q3)*sin(q2))/1000 - (5723*sin(q2)*sin(q3))/10000) + m5*((5723*sin(q2)*sin(q3))/10000 - (5723*cos(q2)*cos(q3))/10000 + (9*cos(q4)*(cos(q2)*sin(q3) + cos(q3)*sin(q2)))/500 + (9*sin(q4)*(cos(q2)*cos(q3) - sin(q2)*sin(q3)))/500)) - g*gy*(m6*((1157*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/10000 + (1157*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/10000 + (13*sin(q5)*(cos(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)) - sin(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1))))/500 - (5723*cos(q2)*sin(q1)*sin(q3))/10000 - (5723*cos(q3)*sin(q1)*sin(q2))/10000) - m4*((7*sin(q1)*sin(q2)*sin(q3))/1000 - (7*cos(q2)*cos(q3)*sin(q1))/1000 + (5723*cos(q2)*sin(q1)*sin(q3))/10000 + (5723*cos(q3)*sin(q1)*sin(q2))/10000) + m5*((9*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/500 + (9*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/500 - (5723*cos(q2)*sin(q1)*sin(q3))/10000 - (5723*cos(q3)*sin(q1)*sin(q2))/10000)) + g*gx*(m6*((1157*cos(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)))/10000 - (1157*sin(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)))/10000 - (13*sin(q5)*(cos(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)) + sin(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3))))/500 + (5723*cos(q1)*cos(q2)*sin(q3))/10000 + (5723*cos(q1)*cos(q3)*sin(q2))/10000) + m4*((5723*cos(q1)*cos(q2)*sin(q3))/10000 - (7*cos(q1)*cos(q2)*cos(q3))/1000 + (5723*cos(q1)*cos(q3)*sin(q2))/10000 + (7*cos(q1)*sin(q2)*sin(q3))/1000) + m5*((9*cos(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)))/500 - (9*sin(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)))/500 + (5723*cos(q1)*cos(q2)*sin(q3))/10000 + (5723*cos(q1)*cos(q3)*sin(q2))/10000));
    g*gx*(m5*((9*cos(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)))/500 - (9*sin(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)))/500) - m6*((1157*sin(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)))/10000 - (1157*cos(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)))/10000 + (13*sin(q5)*(cos(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2)) + sin(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3))))/500)) - g*gy*(m6*((1157*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/10000 + (1157*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/10000 + (13*sin(q5)*(cos(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)) - sin(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1))))/500) + m5*((9*cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)))/500 + (9*sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2)))/500)) + g*gz*(m5*((9*cos(q4)*(cos(q2)*sin(q3) + cos(q3)*sin(q2)))/500 + (9*sin(q4)*(cos(q2)*cos(q3) - sin(q2)*sin(q3)))/500) + m6*((13*sin(q5)*(cos(q4)*(cos(q2)*cos(q3) - sin(q2)*sin(q3)) - sin(q4)*(cos(q2)*sin(q3) + cos(q3)*sin(q2))))/500 + (1157*cos(q4)*(cos(q2)*sin(q3) + cos(q3)*sin(q2)))/10000 + (1157*sin(q4)*(cos(q2)*cos(q3) - sin(q2)*sin(q3)))/10000));
    g*gx*m6*((13*sin(q1)*sin(q5))/500 + (13*cos(q5)*(cos(q4)*(cos(q1)*cos(q2)*cos(q3) - cos(q1)*sin(q2)*sin(q3)) - sin(q4)*(cos(q1)*cos(q2)*sin(q3) + cos(q1)*cos(q3)*sin(q2))))/500) - g*gy*m6*((13*cos(q1)*sin(q5))/500 + (13*cos(q5)*(cos(q4)*(sin(q1)*sin(q2)*sin(q3) - cos(q2)*cos(q3)*sin(q1)) + sin(q4)*(cos(q2)*sin(q1)*sin(q3) + cos(q3)*sin(q1)*sin(q2))))/500) + (13*g*gz*m6*cos(q5)*(cos(q4)*(cos(q2)*sin(q3) + cos(q3)*sin(q2)) + sin(q4)*(cos(q2)*cos(q3) - sin(q2)*sin(q3))))/500;
    0];

% disp("C")
% disp(C)

% disp("actual G")
% disp(G')

%% to show the effects of gravity and validity of dynamics model we apply no torques
% Tao=[u(id_offset+46);u(id_offset+47);u(id_offset+48)];
Tao=[0;0;0;0;0;0];

Qpp=inv(M)*(Tao-C*Qp-G-Beta*Qp);
% Qpp=[0;0;0;0;0;0];
% Qpp=[0.1;0.1;0.1;0.1;0.1;0.1];

disp("Qpp")
disp(Qpp')